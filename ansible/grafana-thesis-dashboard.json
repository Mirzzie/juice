{
  "dashboard": {
    "title": "IAST vs RASP Comparative Analysis (Thesis Dashboard)",
    "tags": ["security", "devsecops", "iast", "rasp", "comparison", "thesis"],
    "timezone": "browser",
    "refresh": "30s",
    "panels": [
      {
        "id": 1,
        "title": "üéØ THESIS HYPOTHESIS VALIDATION",
        "type": "text",
        "gridPos": {"h": 4, "w": 24, "x": 0, "y": 0},
        "options": {
          "mode": "markdown",
          "content": "# IAST vs RASP Comparison Study\n\n## Hypothesis\n**RASP provides superior protection by both detecting AND blocking attacks, while IAST only provides detection.**\n\n### Two Test Scenarios:\n- **Scenario 1 (IAST Only)**: DataDog IAST ON, Aikido RASP OFF ‚Üí Detection without blocking\n- **Scenario 2 (IAST + RASP)**: DataDog IAST ON, Aikido RASP ON ‚Üí Detection WITH blocking\n\n**Expected Result:** RASP achieves ~80% blocking rate while IAST has 0% blocking capability."
        }
      },
      {
        "id": 2,
        "title": "üìä Scenario Comparison Overview",
        "type": "stat",
        "gridPos": {"h": 6, "w": 24, "x": 0, "y": 4},
        "targets": [
          {
            "expr": "sum(security_detections_total{tool=\"datadog_iast\",scenario=\"iast-only\"})",
            "legendFormat": "S1: IAST Detections (No Blocking)"
          },
          {
            "expr": "sum(security_detections_total{tool=\"datadog_iast\",scenario=\"iast-rasp\"})",
            "legendFormat": "S2: IAST Detections"
          },
          {
            "expr": "sum(security_detections_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"})",
            "legendFormat": "S2: RASP Detections"
          },
          {
            "expr": "sum(security_blocks_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"})",
            "legendFormat": "S2: RASP BLOCKS ‚úÖ"
          }
        ],
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "orientation": "horizontal"
        }
      },
      {
        "id": 3,
        "title": "üõ°Ô∏è CRITICAL: RASP Blocking Capability (Scenario 2 ONLY)",
        "type": "gauge",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 10},
        "targets": [
          {
            "expr": "(sum(security_blocks_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"}) / sum(security_detections_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"})) * 100",
            "legendFormat": "RASP Block Rate %"
          }
        ],
        "options": {
          "showThresholdLabels": true,
          "showThresholdMarkers": true
        },
        "fieldConfig": {
          "defaults": {
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "red"},
                {"value": 50, "color": "yellow"},
                {"value": 75, "color": "green"}
              ]
            },
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        }
      },
      {
        "id": 4,
        "title": "üìà Scenario 1 vs Scenario 2: Detection Timeline",
        "type": "timeseries",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 10},
        "targets": [
          {
            "expr": "rate(security_detections_total{tool=\"datadog_iast\",scenario=\"iast-only\"}[5m])",
            "legendFormat": "S1: IAST Detection Rate"
          },
          {
            "expr": "rate(security_detections_total{tool=\"datadog_iast\",scenario=\"iast-rasp\"}[5m])",
            "legendFormat": "S2: IAST Detection Rate"
          },
          {
            "expr": "rate(security_detections_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"}[5m])",
            "legendFormat": "S2: RASP Detection Rate"
          },
          {
            "expr": "rate(security_blocks_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"}[5m])",
            "legendFormat": "S2: RASP Block Rate"
          }
        ]
      },
      {
        "id": 5,
        "title": "üî¥ Scenario 1: IAST Only (Detection WITHOUT Blocking)",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 18}
      },
      {
        "id": 6,
        "title": "DAST Vulnerabilities - Scenario 1",
        "type": "bargauge",
        "gridPos": {"h": 6, "w": 8, "x": 0, "y": 19},
        "targets": [
          {
            "expr": "sum by (severity) (dast_vulnerabilities_found{scenario=\"iast-only\",scan_type=\"full\",vuln_name=\"total\"})",
            "legendFormat": "{{severity}}"
          }
        ]
      },
      {
        "id": 7,
        "title": "IAST Detections - Scenario 1",
        "type": "stat",
        "gridPos": {"h": 6, "w": 8, "x": 8, "y": 19},
        "targets": [
          {
            "expr": "sum(security_detections_total{tool=\"datadog_iast\",scenario=\"iast-only\"})",
            "legendFormat": "Total Detections"
          }
        ],
        "options": {
          "colorMode": "value",
          "graphMode": "area"
        }
      },
      {
        "id": 8,
        "title": "RASP Blocks - Scenario 1",
        "type": "stat",
        "gridPos": {"h": 6, "w": 8, "x": 16, "y": 19},
        "targets": [
          {
            "expr": "sum(security_blocks_total{scenario=\"iast-only\"}) or vector(0)",
            "legendFormat": "Blocks (Should be 0)"
          }
        ],
        "options": {
          "colorMode": "background",
          "graphMode": "none"
        },
        "fieldConfig": {
          "defaults": {
            "thresholds": {
              "steps": [
                {"value": 0, "color": "red"}
              ]
            }
          }
        }
      },
      {
        "id": 9,
        "title": "üü¢ Scenario 2: IAST + RASP (Detection WITH Blocking)",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 25}
      },
      {
        "id": 10,
        "title": "DAST Vulnerabilities - Scenario 2",
        "type": "bargauge",
        "gridPos": {"h": 6, "w": 8, "x": 0, "y": 26},
        "targets": [
          {
            "expr": "sum by (severity) (dast_vulnerabilities_found{scenario=\"iast-rasp\",scan_type=\"full\",vuln_name=\"total\"})",
            "legendFormat": "{{severity}}"
          }
        ]
      },
      {
        "id": 11,
        "title": "IAST Detections - Scenario 2",
        "type": "stat",
        "gridPos": {"h": 6, "w": 8, "x": 8, "y": 26},
        "targets": [
          {
            "expr": "sum(security_detections_total{tool=\"datadog_iast\",scenario=\"iast-rasp\"})",
            "legendFormat": "Total Detections"
          }
        ],
        "options": {
          "colorMode": "value",
          "graphMode": "area"
        }
      },
      {
        "id": 12,
        "title": "RASP BLOCKS - Scenario 2 ‚úÖ",
        "type": "stat",
        "gridPos": {"h": 6, "w": 8, "x": 16, "y": 26},
        "targets": [
          {
            "expr": "sum(security_blocks_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"})",
            "legendFormat": "Attacks Blocked"
          }
        ],
        "options": {
          "colorMode": "background",
          "graphMode": "area"
        },
        "fieldConfig": {
          "defaults": {
            "thresholds": {
              "steps": [
                {"value": 0, "color": "red"},
                {"value": 10, "color": "yellow"},
                {"value": 30, "color": "green"}
              ]
            }
          }
        }
      },
      {
        "id": 13,
        "title": "üìä Side-by-Side DAST Comparison",
        "type": "bargauge",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 32},
        "targets": [
          {
            "expr": "sum(dast_vulnerabilities_found{scenario=\"iast-only\",scan_type=\"full\",vuln_name=\"total\"})",
            "legendFormat": "Scenario 1: IAST Only"
          },
          {
            "expr": "sum(dast_vulnerabilities_found{scenario=\"iast-rasp\",scan_type=\"full\",vuln_name=\"total\"})",
            "legendFormat": "Scenario 2: IAST + RASP"
          }
        ],
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient"
        }
      },
      {
        "id": 14,
        "title": "üéØ KEY THESIS METRIC: Block Rate Comparison",
        "type": "bargauge",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 32},
        "targets": [
          {
            "expr": "(sum(security_blocks_total{scenario=\"iast-only\"}) or vector(0)) / (sum(security_detections_total{scenario=\"iast-only\"}) or vector(1)) * 100",
            "legendFormat": "Scenario 1: Block Rate (0%)"
          },
          {
            "expr": "(sum(security_blocks_total{scenario=\"iast-rasp\"}) / sum(security_detections_total{scenario=\"iast-rasp\"})) * 100",
            "legendFormat": "Scenario 2: Block Rate (~80%)"
          }
        ],
        "options": {
          "orientation": "horizontal",
          "displayMode": "lcd"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "max": 100
          }
        }
      },
      {
        "id": 15,
        "title": "üî¨ Detailed IAST Detections by Type (Both Scenarios)",
        "type": "bargauge",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 40},
        "targets": [
          {
            "expr": "sum by (vuln_type, scenario) (security_detections_total{tool=\"datadog_iast\"})",
            "legendFormat": "{{scenario}}: {{vuln_type}}"
          }
        ],
        "options": {
          "orientation": "horizontal"
        }
      },
      {
        "id": 16,
        "title": "üõ°Ô∏è RASP Attack Type Distribution (Scenario 2 Only)",
        "type": "piechart",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 40},
        "targets": [
          {
            "expr": "sum by (attack_type) (security_blocks_total{tool=\"aikido_rasp\",scenario=\"iast-rasp\"})",
            "legendFormat": "{{attack_type}}"
          }
        ]
      },
      {
        "id": 17,
        "title": "üìã SAST Baseline (Semgrep - Runs Once)",
        "type": "bargauge",
        "gridPos": {"h": 6, "w": 12, "x": 0, "y": 48},
        "targets": [
          {
            "expr": "sum by (severity) (sast_vulnerabilities_found{rule_id=\"total\"})",
            "legendFormat": "{{severity}}"
          }
        ]
      },
      {
        "id": 18,
        "title": "‚ö° Current Test Status",
        "type": "stat",
        "gridPos": {"h": 6, "w": 12, "x": 12, "y": 48},
        "targets": [
          {
            "expr": "current_scenario_id",
            "legendFormat": "Scenario"
          },
          {
            "expr": "current_scan_phase",
            "legendFormat": "Phase"
          }
        ],
        "options": {
          "colorMode": "background",
          "orientation": "horizontal"
        },
        "fieldConfig": {
          "defaults": {
            "mappings": [
              {"type": "value", "value": 1, "text": "Scenario 1: IAST Only"},
              {"type": "value", "value": 2, "text": "Scenario 2: IAST+RASP"}
            ]
          }
        }
      },
      {
        "id": 19,
        "title": "üìä THESIS DATA TABLE: Complete Comparison",
        "type": "table",
        "gridPos": {"h": 10, "w": 24, "x": 0, "y": 54},
        "targets": [
          {
            "expr": "sum by (scenario) (security_detections_total{tool=\"datadog_iast\"})",
            "format": "table",
            "instant": true
          },
          {
            "expr": "sum by (scenario) (security_detections_total{tool=\"aikido_rasp\"})",
            "format": "table",
            "instant": true
          },
          {
            "expr": "sum by (scenario) (security_blocks_total{tool=\"aikido_rasp\"})",
            "format": "table",
            "instant": true
          },
          {
            "expr": "sum by (scenario) (dast_vulnerabilities_found{vuln_name=\"total\",scan_type=\"full\"})",
            "format": "table",
            "instant": true
          }
        ],
        "transformations": [
          {
            "id": "merge"
          },
          {
            "id": "organize",
            "options": {
              "renameByName": {
                "scenario": "Test Scenario",
                "Value #A": "IAST Detections",
                "Value #B": "RASP Detections",
                "Value #C": "RASP Blocks",
                "Value #D": "DAST Vulnerabilities"
              }
            }
          }
        ]
      }
    ],
    "schemaVersion": 36,
    "version": 1,
    "uid": "thesis-comparison",
    "editable": true
  }
}
