{
  "uid": "thesis-jarvis",
  "title": "‚ö° JARVIS: IAST vs RASP Analysis",
  "description": "Thesis Security Monitoring System",
  "timezone": "browser",
  "schemaVersion": 39,
  "refresh": "5s",
  "style": "dark",
  "time": {
    "from": "now-15m",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": ["5s", "10s", "30s", "1m"],
    "time_options": ["5m", "15m", "1h", "6h", "12h", "24h"]
  },
  "panels": [
    {
      "id": 100,
      "gridPos": { "h": 3, "w": 8, "x": 0, "y": 0 },
      "type": "stat",
      "title": "",
      "transparent": true,
      "targets": [
        {
          "expr": "thesis_scenario_id",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "mappings": [
            {
              "type": "value",
              "options": {
                "0": { "text": "‚è∏ STANDBY", "color": "#3d5a80", "index": 0 },
                "1": { "text": "‚ñ∂ BASELINE", "color": "#00d4ff", "index": 1 },
                "2": { "text": "‚óâ DETECTION", "color": "#ffd60a", "index": 2 },
                "3": { "text": "üõ° BLOCKING", "color": "#06d6a0", "index": 3 }
              }
            }
          ],
          "noValue": "OFFLINE"
        }
      },
      "options": {
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "textMode": "auto"
      }
    },
    {
      "id": 101,
      "gridPos": { "h": 3, "w": 5, "x": 8, "y": 0 },
      "type": "stat",
      "title": "",
      "transparent": true,
      "targets": [
        {
          "expr": "sum(thesis_rasp_blocks_total) or vector(0)",
          "legendFormat": "BLOCKS",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "fixed", "fixedColor": "#ef476f" },
          "unit": "short",
          "noValue": "0",
          "displayName": "üõ° BLOCKED"
        }
      },
      "options": {
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center"
      }
    },
    {
      "id": 102,
      "gridPos": { "h": 3, "w": 5, "x": 13, "y": 0 },
      "type": "stat",
      "title": "",
      "transparent": true,
      "targets": [
        {
          "expr": "sum(thesis_rasp_detections_total) or vector(0)",
          "legendFormat": "DETECTS",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "fixed", "fixedColor": "#ffd60a" },
          "unit": "short",
          "noValue": "0",
          "displayName": "üëÅ DETECTED"
        }
      },
      "options": {
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center"
      }
    },
    {
      "id": 103,
      "gridPos": { "h": 3, "w": 6, "x": 18, "y": 0 },
      "type": "stat",
      "title": "",
      "transparent": true,
      "targets": [
        {
          "expr": "sum(thesis_iast_detections_total) or vector(0)",
          "legendFormat": "IAST",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "fixed", "fixedColor": "#9d4edd" },
          "unit": "short",
          "noValue": "0",
          "displayName": "üî¨ IAST EVENTS"
        }
      },
      "options": {
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center"
      }
    },
    {
      "id": 1,
      "gridPos": { "h": 5, "w": 8, "x": 0, "y": 3 },
      "type": "gauge",
      "title": "RASP EFFICIENCY",
      "transparent": true,
      "targets": [
        {
          "expr": "clamp_min(clamp_max((sum(increase(thesis_rasp_blocks_total[15m])) / (sum(increase(thesis_rasp_detections_total[15m])) + sum(increase(thesis_rasp_blocks_total[15m])) + 0.001)) * 100, 100), 0) or vector(0)",
          "legendFormat": "Block Rate",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "#ef476f", "value": null },
              { "color": "#ffd60a", "value": 40 },
              { "color": "#06d6a0", "value": 75 }
            ]
          },
          "unit": "percent",
          "min": 0,
          "max": 100,
          "noValue": "0"
        }
      },
      "options": {
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "orientation": "auto",
        "showThresholdLabels": false,
        "showThresholdMarkers": true
      }
    },
    {
      "id": 2,
      "gridPos": { "h": 5, "w": 8, "x": 8, "y": 3 },
      "type": "stat",
      "title": "RESPONSE TIME",
      "transparent": true,
      "targets": [
        {
          "expr": "thesis_request_latency_ms",
          "legendFormat": "Latency",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ms",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "#06d6a0", "value": null },
              { "color": "#ffd60a", "value": 100 },
              { "color": "#ef476f", "value": 250 }
            ]
          },
          "noValue": "0",
          "decimals": 1
        }
      },
      "options": {
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "center"
      }
    },
    {
      "id": 3,
      "gridPos": { "h": 5, "w": 8, "x": 16, "y": 3 },
      "type": "bargauge",
      "title": "CONTAINER VULNERABILITIES",
      "transparent": true,
      "targets": [
        {
          "expr": "thesis_trivy_vulns_total",
          "legendFormat": "{{severity}}",
          "refId": "A",
          "instant": true
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "#3d5a80", "value": null },
              { "color": "#ffd60a", "value": 1 },
              { "color": "#ef476f", "value": 10 }
            ]
          },
          "noValue": "0"
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "CRITICAL" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#d00000", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "HIGH" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ef476f", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "MEDIUM" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ffd60a", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "LOW" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#00d4ff", "mode": "fixed" } }]
          }
        ]
      },
      "options": {
        "orientation": "horizontal",
        "displayMode": "gradient",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "showUnfilled": true
      }
    },
    {
      "id": 4,
      "gridPos": { "h": 9, "w": 16, "x": 0, "y": 8 },
      "type": "timeseries",
      "title": "‚öîÔ∏è THREAT DETECTION TIMELINE",
      "transparent": true,
      "targets": [
        {
          "expr": "sum(increase(thesis_iast_detections_total[30s])) by (vuln_type)",
          "legendFormat": "IAST: {{vuln_type}}",
          "refId": "A"
        },
        {
          "expr": "increase(thesis_rasp_blocks_total[30s])",
          "legendFormat": "‚õî RASP BLOCK",
          "refId": "B"
        },
        {
          "expr": "increase(thesis_rasp_detections_total[30s])",
          "legendFormat": "üëÅ RASP DETECT",
          "refId": "C"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 15,
            "drawStyle": "line",
            "pointSize": 6,
            "showPoints": "auto",
            "spanNulls": true,
            "lineInterpolation": "smooth",
            "gradientMode": "opacity"
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": [
          {
            "matcher": { "id": "byRegexp", "options": ".*BLOCK.*" },
            "properties": [
              { "id": "color", "value": { "fixedColor": "#ef476f", "mode": "fixed" } },
              { "id": "custom.lineWidth", "value": 3 },
              { "id": "custom.fillOpacity", "value": 30 }
            ]
          },
          {
            "matcher": { "id": "byRegexp", "options": ".*DETECT.*" },
            "properties": [
              { "id": "color", "value": { "fixedColor": "#ffd60a", "mode": "fixed" } }
            ]
          },
          {
            "matcher": { "id": "byRegexp", "options": ".*IAST.*" },
            "properties": [
              { "id": "color", "value": { "fixedColor": "#9d4edd", "mode": "fixed" } }
            ]
          }
        ]
      },
      "options": {
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": { "mode": "multi", "sort": "desc" }
      }
    },
    {
      "id": 5,
      "gridPos": { "h": 9, "w": 8, "x": 16, "y": 8 },
      "type": "timeseries",
      "title": "‚ö° SYSTEM PERFORMANCE",
      "transparent": true,
      "targets": [
        {
          "expr": "thesis_request_latency_ms",
          "legendFormat": "AVG",
          "refId": "A"
        },
        {
          "expr": "thesis_request_latency_p95_ms",
          "legendFormat": "P95",
          "refId": "B"
        },
        {
          "expr": "thesis_request_latency_p99_ms",
          "legendFormat": "P99",
          "refId": "C"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ms",
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 10,
            "drawStyle": "line",
            "lineInterpolation": "smooth",
            "gradientMode": "scheme"
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "AVG" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#00d4ff", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "P95" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#06d6a0", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "P99" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ffd60a", "mode": "fixed" } }]
          }
        ]
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 6,
      "gridPos": { "h": 6, "w": 12, "x": 0, "y": 17 },
      "type": "timeseries",
      "title": "üõ°Ô∏è RASP ACTIVITY MONITOR",
      "transparent": true,
      "targets": [
        {
          "expr": "increase(thesis_rasp_blocks_total[1m])",
          "legendFormat": "Blocks/min",
          "refId": "A"
        },
        {
          "expr": "increase(thesis_rasp_detections_total[1m])",
          "legendFormat": "Detections/min",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": {
            "lineWidth": 3,
            "fillOpacity": 25,
            "drawStyle": "bars",
            "gradientMode": "hue",
            "barAlignment": 0
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Blocks/min" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ef476f", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "Detections/min" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ffd60a", "mode": "fixed" } }]
          }
        ]
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 7,
      "gridPos": { "h": 6, "w": 12, "x": 12, "y": 17 },
      "type": "timeseries",
      "title": "üî¨ IAST DETECTION STREAM",
      "transparent": true,
      "targets": [
        {
          "expr": "sum(increase(thesis_iast_detections_total[1m])) by (vuln_type)",
          "legendFormat": "{{vuln_type}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": {
            "lineWidth": 2,
            "fillOpacity": 20,
            "drawStyle": "line",
            "lineInterpolation": "smooth",
            "gradientMode": "opacity",
            "stacking": { "mode": "normal", "group": "A" }
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "SQL Injection" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ef476f", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "XSS" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#ffd60a", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "Path Traversal" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#06d6a0", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "Generic" },
            "properties": [{ "id": "color", "value": { "fixedColor": "#9d4edd", "mode": "fixed" } }]
          }
        ]
      },
      "options": {
        "legend": { "displayMode": "list", "placement": "bottom" },
        "tooltip": { "mode": "multi" }
      }
    }
  ],
  "templating": { "list": [] },
  "annotations": { "list": [] }
}