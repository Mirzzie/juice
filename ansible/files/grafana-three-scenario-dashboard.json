{
  "dashboard": {
    "id": null,
    "title": "FINAL THESIS: IAST vs RASP Evaluation (Real-Time)",
    "tags": ["thesis", "rasp", "iast", "security", "real-time"],
    "timezone": "browser",
    "schemaVersion": 36,
    "refresh": "5s",
    "panels": [
      {
        "id": 1,
        "title": "üéØ THESIS HYPOTHESIS & SCENARIO CONTEXT",
        "type": "text",
        "gridPos": {"h": 4, "w": 24, "x": 0, "y": 0},
        "options": {
          "mode": "markdown",
          "content": "# IAST vs RASP Comparative Analysis\n\n**Hypothesis:** RASP (Runtime Application Self-Protection) provides superior security by **actively blocking** attacks that IAST only detects, with negligible performance overhead.\n\n### üß™ Active Scenarios:\n1.  **üîµ Baseline (IAST Only):** Vulnerabilities reported, but attacks **SUCCEED (HTTP 200)**.\n2.  **üü† Detection (RASP Log):** Attacks detected deep in code, attacks **SUCCEED (HTTP 200)**, logs generated.\n3.  **üü¢ Blocking (RASP Protect):** Attacks intercepted in runtime, attacks **BLOCKED (HTTP 403)**."
        }
      },
      {
        "id": 2,
        "title": "CURRENT ACTIVE SCENARIO",
        "type": "stat",
        "gridPos": {"h": 4, "w": 12, "x": 0, "y": 4},
        "targets": [
          {
            "expr": "thesis_scenario_id",
            "legendFormat": "Current Scenario"
          }
        ],
        "options": {
          "colorMode": "background",
          "graphMode": "none"
        },
        "fieldConfig": {
          "defaults": {
            "mappings": [
              {"type": "value", "value": 1, "text": "1. BASELINE (IAST ONLY)", "color": "blue"},
              {"type": "value", "value": 2, "text": "2. RASP DETECTION", "color": "orange"},
              {"type": "value", "value": 3, "text": "3. RASP BLOCKING", "color": "green"}
            ],
            "thresholds": {"mode": "absolute", "steps": [{"value": 0, "color": "gray"}]}
          }
        }
      },
      {
        "id": 3,
        "title": "ATTACK BLOCK RATE (The Kill Shot Metric)",
        "type": "stat",
        "gridPos": {"h": 4, "w": 12, "x": 12, "y": 4},
        "targets": [
          {
            "expr": "sum(rate(juice_shop_http_server_request_duration_seconds_count{http_response_status_code=\"403\"}[1m])) / sum(rate(juice_shop_http_server_request_duration_seconds_count[1m])) * 100",
            "legendFormat": "Block Rate %"
          }
        ],
        "options": {
          "colorMode": "value",
          "graphMode": "area"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "red"},
                {"value": 1, "color": "red"},
                {"value": 80, "color": "green"}
              ]
            }
          }
        }
      },
      {
        "id": 10,
        "title": "‚öîÔ∏è  TOOL COMPARISON: Datadog IAST vs Aikido RASP (Live Logs)",
        "type": "timeseries",
        "gridPos": {"h": 8, "w": 24, "x": 0, "y": 8},
        "targets": [
          {
            "expr": "increase(thesis_iast_detections_total[1m])",
            "legendFormat": "üê∂ Datadog IAST Detections",
            "refId": "A"
          },
          {
            "expr": "increase(thesis_rasp_detections_total[1m])",
            "legendFormat": "ü•ã Aikido RASP Detections",
            "refId": "B"
          },
          {
            "expr": "increase(thesis_rasp_blocks_total[1m])",
            "legendFormat": "üõ°Ô∏è Aikido RASP BLOCKS",
            "refId": "C"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "palette-classic"},
            "custom": {
              "lineWidth": 4,
              "fillOpacity": 20,
              "drawStyle": "bars"
            }
          },
          "overrides": [
            {"matcher": {"id": "byName", "options": "üê∂ Datadog IAST Detections"}, "properties": [{"id": "color", "value": {"fixedColor": "purple", "mode": "fixed"}}]},
            {"matcher": {"id": "byName", "options": "ü•ã Aikido RASP Detections"}, "properties": [{"id": "color", "value": {"fixedColor": "orange", "mode": "fixed"}}]},
            {"matcher": {"id": "byName", "options": "üõ°Ô∏è Aikido RASP BLOCKS"}, "properties": [{"id": "color", "value": {"fixedColor": "green", "mode": "fixed"}}]}
          ]
        }
      },
      {
        "id": 4,
        "title": "üõ°Ô∏è Security Effectiveness: Allowed vs Blocked Traffic",
        "type": "timeseries",
        "gridPos": {"h": 10, "w": 16, "x": 0, "y": 16},
        "targets": [
          {
            "expr": "sum(rate(juice_shop_http_server_request_duration_seconds_count{http_response_status_code=\"200\"}[1m]))",
            "legendFormat": "‚úÖ Allowed Traffic (HTTP 200)",
            "refId": "A"
          },
          {
            "expr": "sum(rate(juice_shop_http_server_request_duration_seconds_count{http_response_status_code=\"403\"}[1m]))",
            "legendFormat": "üö´ RASP Blocks (HTTP 403)",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "lineWidth": 4,
              "fillOpacity": 20
            },
            "color": {"mode": "palette-classic"}
          }
        }
      },
      {
        "id": 5,
        "title": "‚ö° Performance Overhead (Latency)",
        "type": "timeseries",
        "gridPos": {"h": 10, "w": 8, "x": 16, "y": 16},
        "targets": [
          {
            "expr": "rate(juice_shop_http_server_request_duration_seconds_sum[1m]) / rate(juice_shop_http_server_request_duration_seconds_count[1m]) * 1000",
            "legendFormat": "Avg Latency (ms)"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "ms",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "green"},
                {"value": 100, "color": "yellow"},
                {"value": 500, "color": "red"}
              ]
            }
          }
        }
      },
      {
        "id": 6,
        "title": "SAST Vulnerability Profile (Static)",
        "type": "bargauge",
        "gridPos": {"h": 6, "w": 12, "x": 0, "y": 26},
        "targets": [
          {
            "expr": "thesis_sast_vulns",
            "legendFormat": "{{severity}}"
          }
        ],
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient"
        }
      },
      {
        "id": 7,
        "title": "OpenTelemetry Data Flow",
        "type": "stat",
        "gridPos": {"h": 6, "w": 12, "x": 12, "y": 26},
        "targets": [
          {
            "expr": "rate(juice_shop_http_server_request_duration_seconds_count[1m])",
            "legendFormat": "Spans Processed / Sec"
          }
        ],
        "options": {
          "colorMode": "value"
        }
      }
    ]
  }
}